window.addEventListener("load", () => {
    document.querySelector(".main").classList.remove("hidden"), document.querySelector(".home").classList.add("active"), document.querySelector(".page-loader").classList.add("fade-out"), setTimeout(() => {
        document.querySelector(".page-loader").style.display = "none"
    }, 600)
});
const tabsContainer = document.querySelector(".about-tabs"), aboutSection = document.querySelector(".about");

function togglePortfolioPopup() {
    document.querySelector(".portfolio-popup").classList.toggle("open"), document.body.classList.toggle("hide-scrolling"), document.querySelector(".main").classList.toggle("fade-out")
}

function portfolioItemDetails(e) {
    document.querySelector(".portfolio-popup-thumbnail img").src = e.querySelector(".portfolio-item img").src, document.querySelector(".portfolio-popup-header h3").innerHTML = e.querySelector(".portfolio-item-title").innerHTML, document.querySelector(".portfolio-popup-body").innerHTML = e.querySelector(".portfolio-item-details").innerHTML
}

tabsContainer.addEventListener("click", e => {
    if (e.target.classList.contains("tab-item") && !e.target.classList.contains("active")) {
        tabsContainer.querySelector(".active").classList.remove("active"), e.target.classList.add("active");
        const t = e.target.getAttribute("data-target");
        aboutSection.querySelector(".tab-content.active").classList.remove("active"), aboutSection.querySelector(t).classList.add("active")
    }
}), document.addEventListener("click", e => {
    e.target.classList.contains("portfolio-item-img") && (togglePortfolioPopup(), document.querySelector(".portfolio-popup").scrollTo(0, 0), portfolioItemDetails(e.target.parentElement))
}), document.querySelector(".portfolio-popup-close").addEventListener("click", togglePortfolioPopup), document.addEventListener("click", e => {
    e.target.classList.contains("portfolio-popup-inner") && togglePortfolioPopup()
});
const burger = document.querySelector(".burger");

function hideSection() {
    document.querySelector("section.active").classList.toggle("fade-out")
}

function toggleNavbar() {
    document.querySelector(".header").classList.toggle("active")
}

burger.addEventListener("click", () => {
    burger.classList.toggle("active"), hideSection(), toggleNavbar()
}), document.addEventListener("click", e => {
    e.target.classList.contains("link-item") && "" !== e.target.hash && (document.querySelector(".overlay").classList.add("active"), burger.classList.add("hide"), burger.classList.remove("active"), document.querySelector(".toggle").classList.add("hide"), e.target.classList.contains("nav-link") ? (document.body.classList.add("hide-scrolling"), toggleNavbar()) : hideSection(), setTimeout(() => {
        document.querySelector("section.active").classList.remove("active", "fade-out"), document.querySelector(e.target.hash).classList.add("active"), window.scrollTo(0, 0), document.body.classList.remove("hide-scrolling"), burger.classList.remove("hide"), document.querySelector(".toggle").classList.remove("hide"), document.querySelector(".overlay").classList.remove("active")
    }, 500))
}), window.onload = function () {
    const e = document.querySelector(".home"), t = document.querySelector(".home__avatar"), o = 20, r = .05;
    let i = 0, a = 0, n = 0, c = 0;
    !function e() {
        i += (n - i) * r, a += (c - a) * r, t.style.transform = `translate(${i / o}%, ${a / o}%)`, requestAnimationFrame(e)
    }(), e.addEventListener("mousemove", function (t) {
        const o = e.offsetWidth, r = e.offsetHeight, i = t.pageX - o / 2, a = t.pageY - r / 2;
        n = i / o * 100, c = a / r * 100
    })
};
let darkMode = localStorage.getItem("darkMode");
const darkModeToggle = document.querySelector(".toggle"), enableDarkMode = () => {
    document.body.classList.add("darkmode"), localStorage.setItem("darkMode", "enabled")
}, disableDarkMode = () => {
    document.body.classList.remove("darkmode"), localStorage.setItem("darkMode", null)
};
"enabled" === darkMode && enableDarkMode(), darkModeToggle.addEventListener("click", () => {
    "enabled" !== (darkMode = localStorage.getItem("darkMode")) ? enableDarkMode() : (document.body.classList.remove("darkmode"), localStorage.setItem("darkMode", null))
});
const form = document.getElementById("contact-form");

async function handleSubmit(e) {
    e.preventDefault();
    const t = document.getElementById("form-status"), o = document.getElementById("contact-submit"),
        r = new FormData(e.target);
    fetch(e.target.action, {method: form.method, body: r, headers: {Accept: "application/json"}}).then(e => {
        t.textContent = "Thanks for your submission!", o.classList.remove("active"), form.reset()
    }).catch(e => {
        t.innerHTML = "Oops! There was a problem submitting your form"
    }), setTimeout(() => {
        t.textContent = ""
    }, 5e3)
}

form.addEventListener("submit", handleSubmit), document.querySelectorAll(".button").forEach(e => {
    let t = t => getComputedStyle(e).getPropertyValue(t);
    e.addEventListener("click", o => {
        setTimeout(() => {
            e.classList.contains("active") || (e.classList.add("active"), gsap.to(e, {
                keyframes: [{
                    "--left-wing-first-x": 50,
                    "--left-wing-first-y": 100,
                    "--right-wing-second-x": 50,
                    "--right-wing-second-y": 100,
                    duration: .2,
                    onComplete() {
                        gsap.set(e, {
                            "--left-wing-first-y": 0,
                            "--left-wing-second-x": 40,
                            "--left-wing-second-y": 100,
                            "--left-wing-third-x": 0,
                            "--left-wing-third-y": 100,
                            "--left-body-third-x": 40,
                            "--right-wing-first-x": 50,
                            "--right-wing-first-y": 0,
                            "--right-wing-second-x": 60,
                            "--right-wing-second-y": 100,
                            "--right-wing-third-x": 100,
                            "--right-wing-third-y": 100,
                            "--right-body-third-x": 60
                        })
                    }
                }, {
                    "--left-wing-third-x": 20,
                    "--left-wing-third-y": 90,
                    "--left-wing-second-y": 90,
                    "--left-body-third-y": 90,
                    "--right-wing-third-x": 80,
                    "--right-wing-third-y": 90,
                    "--right-body-third-y": 90,
                    "--right-wing-second-y": 90,
                    duration: .2
                }, {
                    "--rotate": 50,
                    "--left-wing-third-y": 95,
                    "--left-wing-third-x": 27,
                    "--right-body-third-x": 45,
                    "--right-wing-second-x": 45,
                    "--right-wing-third-x": 60,
                    "--right-wing-third-y": 83,
                    duration: .25
                }, {"--rotate": 55, "--plane-x": -8, "--plane-y": 24, duration: .2}, {
                    "--rotate": 40,
                    "--plane-x": 45,
                    "--plane-y": -180,
                    "--plane-opacity": 0,
                    duration: .3,
                    onComplete() {
                        setTimeout(() => {
                            e.removeAttribute("style"), gsap.fromTo(e, {opacity: 0, y: -8}, {
                                opacity: 1,
                                y: 0,
                                clearProps: !0,
                                duration: .3,
                                onComplete() {
                                    e.classList.add("active")
                                }
                            })
                        }, 2e3)
                    }
                }]
            }), gsap.to(e, {
                keyframes: [{
                    "--text-opacity": 0,
                    "--box-shadow-20": 0,
                    "--border-top": 0,
                    "--border-left": 0,
                    "--border-radius": 0,
                    "--plane-opacity": 1,
                    "--background-color": 0,
                    "--bg-hover": 0,
                    "--left-wing-background": t("--primary-darkest"),
                    "--right-wing-background": t("--primary-darkest"),
                    duration: .1
                }, {
                    "--left-wing-background": t("--primary"),
                    "--right-wing-background": t("--primary"),
                    duration: .1
                }, {
                    "--left-body-background": t("--primary-dark"),
                    "--right-body-background": t("--primary-darkest"),
                    duration: .4
                }, {"--success-opacity": 1, "--success-scale": 1, duration: .55, delay: .25}]
            }))
        }, 1e3)
    })
});